# 数据模型

在数据库中用数据模型这个工具来抽象、表示和处理现实世界中的数据和信息。数据模型是现实世界数据特征的抽象。

数据模型是现实世界数据特征的抽象，根据模型应用的不同目的，数据模型分为两类：
- 概念模型：也称为信息模型。它是按用户的观点来对数据和信息建模，主要用于数据库设计。
- 数据模型：
	- **逻辑**数据模型：主要包括网络模型、层次模型、关系模型、面向对象模型，对象关系模型等。
	- **物理**数据模型：对数据最低层次的抽象，它描述数据在系统内部的表示方法和存取方法，在磁盘或磁带上的存储方式和存取方式。

> [!note] 数据模型 (广义) 是数据研究的一个核心问题。
> - 为了便于设计数据模型，常先将现实世界抽象为一种**概念模型**，然后再将概念模型转换为特定的数据模型。
> - 每个 DBMS 都是基于某种**数据模型**(狭义) 的，传统的数据模型包括：层次模型、网状模型和关系模型。

> [!tip]
> - 逻辑数据模型是按计算机系统的观点对数据建模，主要用于 DBMS 的实现。
> - 物理模型的实现是 DBMS 的任务，数据库设计人员要了解和选择物理模型。

## E-R 概念模型

> [!definition|] 概念模型
用于信息世界的建模，是现实世界到机器世界的一个中间层次，是设计数据库的有力工具，是数据库设计人员与用户之间的进行交流的语言（面向用户）

对概念模型具有以下基本要求：
- 有较强的语义表达能力，能够方便、直接地表达应用中的各种语义知识
- 简单、清晰、易于用户理解

### 基本概念

#### 实体 (Entity)

客观存在并可以相互区别的事物称为**实体**。

> [!example] 可以是具体的对象，如一本书、一个学生、一辆车。也可以是抽象的概念或联系，如一堂课，一次比赛。

#### 属性 (Attribute)

实体所具有的某一特征称为**属性**，一个实体可以由若干属性来刻画。

属性一般有*类型*和*值*，常见的键值对就是属性的一种表述。
  - 类型：属性名，如价格，名字
  - 值：具体的内容，如 100$，《数据库原理》

> [!example]
> 学生实体有学号、姓名、年龄、性别、系等方面的属性。其中，
> - 姓名、年龄、性别是属性的型。
> - 张立、20、男是属性的值。属性值的集合表示了一个学生实体。

#### 联系 (Relationship)

在现实世界中，实物内部以及实物之间是有联系的。
  - **实体内部的联系**：通常指组成实体的各属性之间的联系
  - **实体之间的联系**：指不同实体集之间的联系。

> [!note] 实体集之间的联系
> - 一对一联系：实体集 A 中的一个实体**至多**与实体集 B 中的一个实体相对应，反之亦然。记为 1:1。
> - 一对多联系：实体集 A 中的一个实体与实际集 B 中的多个实体相对应。反之，实体集 B 中的一个实体**至多**与实体集 A 中的一个实体相对应。记为 1:n。
> - 多对多联系：实体集 A 中的一个实体与实体集 B 中的多个实体相对应，反之亦然。记为 m:n。

> [!note] 多元联系
> 多个实体集之间也可以存在有联系，称为多元联系。例如：
> - 一个供应商可供应多种零件给多个工程。
> - 一个工程可由多个供应商供应多种零件。
> - 一种零件可由多个供应商供给多个工程。
>
> 供应商、零件和工程间存在多对多的联系，表示为 m:n:p。

### E-R 概念模型

> [!tip] 概念模型的表示方法很多，最著名的是 E-R 模型。

E-R G 概念模型 (Entity-Relationship Approach)，即用 E-R 图来描述现实世界的概念模型，E-R 方法也称为 E-R 模型。

> [!note] E-R 图的基本构成
> - **实体**：用*矩形*表示，框内写明实体名。
> - **属性**：用*椭圆形*表示，用属性名标注，并将椭圆形框用无向边与实体或者联系连接。
> - **联系**：用*菱形*表示，框内标明联系名，分别用连线将关联的实体连接起来，在连线旁标明实体间联系的类型。

> [!note] E-R 图的拓展语法
> - E-R 模型中实体间的联系提供了较多语义
>   - **基数比约束**：如在二元联系中有 1:1，1:n，m:n 的联系
>   - **参与约束**：根据实体集中的实体是否全部参与联系来描述实体参与联系的约束
> 	- 完全参与：一个实体集中的所有实体都参与联系。
> 	- 部分参与：一个实体集中存在实体不参与联系。
> 	- 例子：在教师与课程联系中，一门课至少要有一位教师讲授，而有教师不参与授课。因此，在该联系中，课程实体完全参与联系，教师实体部分参与联系。
>   - **实体参与度**：实体参与联系的最小与最大次数。例如，规定一个学生最少选修 2 门课，最多选修 5 门课，则学生在选课联系中的参与度是 (2,5)。
> - **弱实体**：用双矩形框表示。
> 	- 一种特殊的实体，这种实体的存在是依赖于其他实体而存在的。
> 	- 为了表示 E-R 模型在联系中完全参与，与菱形框间用双线连接。
> 	- 相对于弱实体，它所依赖的实体称为强实体。
> - **子类实体**：一个实体集是具有共同特性的一类实体的集合，但有时需要将实体集根据个体的不同特性分为多个子集
> 	- 子类：较小的类：如职工
> 	- 超类：较大的类：如职工可以分为教师、保洁

E-R 模型被广泛地用于数据库概念模型的设计。
- 在 E-R 图中仅表示现实世界中的信息结构及信息间的关系，不涉及任何信息在计算机中的表示。
- 只要用户的需求不变，E-R 模型是稳定的。
- 运用 E-R 模型，可以很方便地将其转换为具体的 DBMS 所支持的数据模型。

## 层次数据模型

层次模型是数据库系统中最早出现的**数据模型**。层次数据模型用树型结构表示了各类实体以及实体间的联系。

满足下面两个条件的基本层次联系的集合为层次模型：
- 有且只有一个节点没有双亲节点，这个节点被称为根节点
- 根以外的其它结点有且只有一个双亲结点

> [!note] 层次模型的优点
> - 数据结构比较简单，清晰
> - 层次数据库的查询效率高
> - 它提供了良好的数据完整性支持

> [!note] 层次模型的缺点
> - 不能直接表示两个以上的实体型间的复杂的联系和实体型简的多对多联系，只能通过引入冗余数据或者创建虚拟节点的方法来解决，易产生不一致性
> - 对数据的插入和删除的操作限制太多
> - 查询子女节点必须通过双亲节点
> - 由于结构严密，层次命令趋于程序化

## 网状数据模型

网状模型克服了层次模型无法表示非层次关系的缺陷。满足下面两个条件的基本层次联系的集合称为网状模型：
- 允许一个以上的节点无双亲
- 一个节点可以有多于一个的双亲

> [!note] 网状数据模型的优点
> - 能够更为直接的描绘现实世界
> - 用指针实现数据间的联系，具有良好的性能，存取效率较高

> [!note] 网状数据模型的缺点
> - 结构比较复杂，而且随着应用环境的扩大，数据库的结构就变得越来越复杂，不利于用户最终掌握。
> - 其 DDl 与 DML 语言较为复杂，用户不容易使用。

## 关系数据模型

在 [[数据库/关系数据库|关系数据模型]] 中，基本数据结构被限制为二维表，一张二维表被称为一个关系。关系是数学集合论中的一个概念，关系模型是以关系为基础发展起来的。
1. 关系 (relation)：关系是一张二维表，是有多个行和列组成的。一个关系可用来描述一个实体集。
2. 属性 (attribute)：一个关系有多个列，每一列为关系的一个属性。
3. 域 (domain)：一个属性对应的值的集合。域是属性的取值范围。
4. 元组 (tuple)：关系是元组的集合，一个元组对应实体集中的一个个体。一个元组由若干分量组成，一个分量对应一个属性值。
5. 键 (key)：键是一个或多个属性组成的，能够唯一标识一个元组。
	- 一个关系中可能有多组属性都能够起到标识元组的作用。因此，一个关系中可能存在多个键。通常选择其中一个作为*主键*，其余为*候选键*。

> [!example] 快速理解
> 1. 关系：一张表格。
> 2. 属性：表格的列。
> 3. 域：每个属性的取值范围。
> 4. 元组：表格的一行。
> 5. 键：在一个表格中值唯一的属性组。

### 关系模式

我们把对关系结构的描述称为**关系模式**，关系模型可以使用如下形式表示：
	- 关系名（属性名 1，属性名 2，......，属性名 n）
	- 例如：学生 (学号, 姓名, 出生年月, 性别, 入学年份, 班级)

**关系数据库模式**是一组关系模式的集合，这组关系模式对应的关系的集合称为关系数据库。关系模型中最基本的数据结构就是关系。

> [!note] E-R 模式中联系是单独描述的。而在关系模式中，联系使用表来描述。

> [!note] 关系模型的基本概念
> - 最基本的规范条件：关系的每一个分量必须是一个不可分的数据项
> - 关系模型的数据完整性约束
>   - 为了维护数据库中的数据与现实世界的一致性，需要对数据施加一定的约束条件：实体完整性，参照完整性，用户自定义完整性。
> - 关系模型中的数据操作
>   - 关系模型中，对关系中的数据可进行查询、插入、删除和修改操作
>   - 关系数据库系统中，对数据的全部操作都可以归结为对关系的运算。关系运算分为关系代数和关系演算。

> [!note] 关系模型优点：
>   1. 数据结构简单
>   2. 一体化的数据子语言
>   3. 数据独立性高
>   4. 面向集合的存取方式
>   5. 坚实的理论基础
>   6. 有利于开展其他应用

> [!tip] E-R 模型与关系模型的关系
> |      |            E-R 模型             |           关系模型           |
> | :----: | :-------------------------: | :--------------------: |
> | 数据结构 | 实体集、实体集属性、联系集与属性、实体的实例、主键、候选键 | 关系表，表的列、表和列、表的行、表的主键、候选键 |
> | 数据操作 |               无               |     关系代数、关系演算、SQL 语句     |
> |  约束  |        一般性约束、键约束、参与约束         |   实体完整性、参照完整性、用于自定义完整性   |

### 面向对象数据模型

对象关系数据库系统 (Object Relational Database System, ORDBS) 是面向对象数据模型和关系数据模型相结合的产物。其核心概念是面向对象思想。
1. 对象：对象是由一组数据结构和在这组数据结构上的操作的程序代码封装起来的基本单位。
	- 属性集合 (Attribute)：属性描述对象的状态、组成和特性
	- 方法集合 (Method)：描述了对象的行为特性
2. 对象标识：面向对象数据库中的每个对象都有唯一的不变的标识称为对象标识
	- 永久持续性
	- 独立与值的、系统全局唯一的
3. 封装：每个对象是其状态与行为的封装
	- 封装是对象的外部界面与内部实现之间实行清晰隔离的一种抽象，外部与对象的通信只能通过消息
	- 对象封装之后查询属性值必须通过调用方法
4. 类：对象类，共享同样属性和方法集的所有对象构成了一个对象类，一个对象是某一类的一个实例。

> [!note] 面向对象数据库研究中存在的问题
> 1. 缺乏通用的数据模型
> 2. 缺乏理论基础
> 3. 缺乏友好的用户界面与工具环境
> 4. 缺乏有力的查询优化
> 5. 商业上没有建立坚实的基础

---
< [[数据库/数据库系统引论|数据库系统引论]] | [[数据库/关系数据库|关系数据库]] >
