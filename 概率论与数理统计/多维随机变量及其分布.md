---
tags:
  - 概率论
  - 概率论与数理统计
aliases:
  - 多维随机变量
---

# 多维随机变量及其分布

> [!definition|Definition] $n$ 维随机变量
> 如果 $X_{1},X_{2},\cdots,X_{n}$ 是定义在同一个样本空间 $\varOmega$ 上的 $n$ 个[[概率论与数理统计/一维随机变量及其分布|随机变量]]，则称 $(X_{1},X_{2},\cdots,X_{n})$ 为 $n$ 维随机变量或者 $n$ 为向量，$X_{i}$ 是第 $i$ 个分量。

例如，当 $n=2$ 时，称 $(X,Y)$ 是二维随机变量或二维随机向量。

## 联合分布函数

> [!definition|Definition] 联合分布函数
> 对任意 $n$ 个实数 $x_{1},x_{2},\cdots,x_{n}$，称 $n$ 元函数
> $$
F(x_{1},x_{2},\cdots,x_{n})=P\{ X_{1}\leqslant x_{1}, X_{2}\leqslant x_{2},\cdots,X_{n}\leqslant x_{n} \}
> $$
> 为 $n$ 维随机变量 $(X_{1},X_{2},\cdots,X_{n})$ 的分布函数或者随机变量 $X_{1},X_{2},\cdots,X_{n}$ 的联合分布函数。

当 $n=2$ 时，对任意的实数 $x,y$，称二元函数
$$
F(x,y)=P\{ X\leqslant x,Y\leqslant y \}
$$
为二维随机变量 $(X,Y)$ 的分布函数或者随机变量 $X,Y$ 的联合分布函数，记为 $(X,Y)\sim F(x,y)$。

> [!note] 二维联合分布函数的性质
> 1. 单调性：$F(x,y)$ 是 $x,y$ 的单调不减函数
> 	- 对于任意固定的 $y$，当 $x_{1}<x_{2}$ 时，$F(x_{1},y)\leqslant F(x_{2},y)$
> 	- 对于任意固定的 $x$，当 $y_{1}<y_{2}$ 时，$F(x,y_{1})\leqslant F(x,y_{2})$
> 2. 右连续性：$F(x,y)$ 是 $x,y$ 的右连续函数
> 	- $\lim\limits_{ x \to x_{0}^+ }F(x,y)=F(x_{0}+0,y)=F(x_{0},y)$
> 	- $\lim\limits_{ y \to yo^+ }F(x,y_{0}+0)=F(x,y_{0})$
> 3. 有界性：$F(-\infty,y)=F(x,-\infty)=F(-\infty,-\infty)=0,F(+\infty,+\infty)=1$
> 4. 非负性：对任意的 $x_{1}<x_{2},y_{1}<y_{2}$ 有
>    $$
P\{ x_{1}<X\leqslant x_{2},y_{1}<Y\leqslant y_{2} \}=F(x_{2},y_{2})-F(x_{2},y_{1})-F(x_{1},y_{2})+F(x_{1},y_{1})\geqslant 0
>    $$

> [!example]- 从几何理解联合分布函数
> ```tikz
> \begin{document}
> \begin{tikzpicture}[scale=1.5]
> \draw [<->] (0,3) node [left] {$y$} -- (0,0) node [left] {$o$} -- (3,0) node [below right] {$x$};
> \draw (-0.5, 2) -- (2,2) node [above]{$(x_1, y_1)$} -- (2, -0.5); 
> \fill[fill=blue, opacity=0.2] (-0.5,-0.5)rectangle(2,2);
> \node at (0.75, 0.75) {$F(x_1,y_1)$};
> \end{tikzpicture}
> \quad\quad\quad
> \begin{tikzpicture}[scale=1.5]
> \draw [<->] (0,3) node [left] {$y$} -- (0,0) node [left] {$o$} -- (3,0) node [below right] {$x$};
> \draw (-0.5, 1.5) -- (1.5,1.5) node [below left]{$(x_1, y_1)$} -- (1.5, -0.5); 
> \draw (-0.5, 2) -- (2,2) node [above]{$(x_2, y_2)$} -- (2, -0.5); 
> \fill[fill=blue, opacity=0.15, even odd rule] (-0.5, -0.5)rectangle(1.5, 1.5)(-0.5,-0.5)rectangle(2,2);
> \fill[fill=red, opacity=0.3] (1.5, 1.5)rectangle(2, 2);
> \draw [->] (1.75, 1.9) -- (1.75, 2.5) node [above] {$P\{ x_{1}<X\leq x_{2},y_{1}<Y \leq y_{2} \}$};
> \end{tikzpicture}
> \end{document}
> ```
> 从几何图形中我们可以看到，计算 $P\{ x_{1}<X\leqslant x_{2},y_{1}<Y\leqslant y_{2} \}$ 即计算红色区域的面积，需要减去 $F(x_{1},y_{2})$ 和 $F(x_{2},y_{1})$ 并加上重复的 $F(x_{1},y_{1})$。

> [!definition|Definition] 边缘分布函数
> 设二维随机变量 $(X,Y)$ 的分布函数为 $F(x,y)$，随机变量 $X$ 和 $Y$ 的分布函数 $F_{X}(x)$ 与 $F_{Y}(y)$ 分别称为 $(X,Y)$ 关于 $X$ 和关于 $Y$ 的边缘分布函数，由概率的性质得
> $$
\begin{aligned}
F_{X}(x)&=P\{ X\leqslant x \}=P\{ X\leqslant x, Y < +\infty \}\\
&=\lim\limits_{ y \to +\infty } P\{ X\leqslant x,Y\leqslant y \}\\
&=\lim\limits_{ y \to +\infty } F(x,y)=F(x,+\infty)
\end{aligned}
> $$
> 同理，有 $F_{Y}(y)=F(+\infty,y)$。

## 常见二维随机变量及其分布

### 二维离散型随机变量

> [!definition|Definition] 二维离散型随机变量
> 如果二维随机变量 $(X,Y)$ 的可能取值是有限对值或可列无限对值，则称 $(X,Y)$ 为二维离散型随机变量。

二维离散型随机变量使用**联合分布律**描述，即
$$
p_{ij}=P\{ X=x_{i},Y=y_{i} \},i,j=1,2,\cdots
$$
记为 $(X,Y)\sim p_{ij}$，联合分布律常用表格形式表示，即
$$
\begin{array}{c|cccc|c}
\hline
{}_{x}\diagdown^y & y_{1} & \cdots & y_{1} & \cdots & P\{ X=x_{i} \} \\
\hline
x_{1} & \quad p_{11}\quad & \quad\cdots\quad & \quad p_{1j}\quad & \quad\cdots\quad & p_{1\cdot} \\
\vdots & \vdots & & \vdots &  & \vdots\\
x_{i} & p_{i 1} & \cdots & p_{ij} & \cdots & p_{i\cdot} \\
\vdots & \vdots &  & \vdots &  & \vdots \\
\hline
P\{ Y=y_{j} \} & p_{\cdot 1} & \cdots & p_{\cdot j} & \cdots & 1 \\
\hline
\end{array}
$$

> [!note] 
> 数列 $\{ p_{ij} \},i,j=1,2,\cdots$ 是某二维离散随机变量的概率分布的充要条件为
> $$
p_{ij}\geqslant_{0},\,\sum_{i=1}^{\infty}\sum_{j=1}^{\infty}p_{ij}=1
> $$

---

如果 $(X,Y)$ 的概率分布为 $p_{ij}$，则 $(X,Y)$ 的分布函数或者 $X$ 和 $Y$ 的联合分布函数为
$$
F(x,y)=P\{ X\leqslant x,Y\leqslant y \}=\sum_{x_{i}\leqslant x}\sum_{y_{j}\leqslant y}p_{ij}
$$
它是以 $(x,y)$ 为顶点的左下角平面上所有 $(X,Y)$ 可能取值的概率的和。

> [!note]
> 设 $G$ 是平面上的某个区域，则
> $$
P\{ (X,Y)\in G \}=\sum_{(x_{i},y_{i})\in G}p_{ij}
> $$

---

$X,Y$ 的**边缘分布**分别为
$$
\begin{gather}
p_{i\cdot}=P\{ X=x_{i} \}=\sum_{j=1}^{\infty}P\{ X=x_{i},Y=y_{j} \}=\sum_{j=1}^{\infty}p_{ij}\\
p_{\cdot j}=P\{ X=x_{i} \}=\sum_{i=1}^{\infty}P\{ X=x_{i},Y=y_{j} \}=\sum_{i=1}^{\infty}p_{ij}\\
\end{gather}
$$

---

如果 $(X,Y)\sim p_{ij}$，对与固定的 $j$，如果 $p_{\cdot j}=P\{ Y=y_{i} \}$，则称
$$
P\{ X=x_{i}\mid Y=y_{j} \}=\frac{P\{ X=x_{i},Y=y_{i} \}}{P\{ y_{j} \}}=\frac{p_{ij}}{p_{\cdot j}}
$$
为 $X$ 在 $Y=y_{i}$ 条件下的**条件分布**。同理，对于固定的 $i$，如果 $p_{i\cdot}>0$，可定义 $Y$ 在 $X=x_{i}$ 条件下的条件分布为
$$
P\{ Y=y_{i}\mid X=x_{i} \}=\frac{p_{ij}}{p_{i\cdot}}
$$

> [!warning]  **条件分布** = **联合分布** / **边缘分布**。

### 二维连续型随机变量

> [!definition|Definition] 二维连续型随机变量
> 如果二维随机变量 $(X,Y)$ 的分布函数 $F(x,y)$ 可以表示为
> $$
F(x,y)=\int_{-\infty}^{y}\text{d}v \int_{-\infty}^{x}f(u,v)\text{d}u,\,(x,y)\in \mathbb{R}^{2}
> $$
> 其中 $f(x,y)$ 是非负可积函数，则称 $(X,Y)$ 为二维连续型随机变量，称 $f(x,y)$ 为 $(X,Y)$ 的概率密度，记为 $(X,Y)\sim f(x,y)$。

> [!note] 
> 二元函数 $f(x,y)$ 是概率密度的充要条件为
> $$
f(x,y)\geqslant 0,\, \int_{-\infty}^{+\infty}\text{d}y\int_{-\infty}^{+\infty}f(x,y)\text{d}x=1
> $$
> 改变 $f(x,y)$ 的有限个点的值 (非负)，$f(x,y)$ 仍然是概率密度。

设 $(X,Y)$ 的分布函数为 $F(x,y)$，概率密度为 $f(x,y)$，则
1. $F(x,y)$ 为 $f(x,y)$ 的二元连续函数，且
$$
F(x,y)=P\{ X\leqslant x,Y\leqslant y \}=\int_{-\infty}^{y}\text{d}v\int_{-\infty}^{x}f(u,v)\text{d}u
$$
2. 设 $G$ 为平面上的某个区域，则
$$
P\{ (X,Y)\in G \}=\iint_{G}f(x,y)\text{d}x\text{d}y
$$
3. 若 $f(x,y)$ 在点 $(x,y)$ 处连续，则 $\dfrac{\partial^{2}F(x,y)}{\partial x\partial y}=f(x,y)$。
4. 若 $F(x,y)$ 连续且可导，则 $(X,Y)$ 是连续型随机变量，且 $\dfrac{\partial^{2} F(x,y)}{\partial x\partial y}$ 是它的概率密度。

---

> [!definition|Definition] 边缘概率密度
> 设 $(X,Y)\sim f(x,y)$，则 $X$ 的边缘分布函数为
> $$
F_{X}(x)=F(x,+\infty)=\int_{-\infty}^{x}\left[ \int_{-\infty}^{+\infty}f(u,v)\text{d}v \right] \text{d}u
> $$
> 所以 $X$ 是连续型随机变量，其概率密度为
> $$
f_{X}(x)=\int_{-\infty}^{+\infty}f(x,y)\text{d}y
> $$
> 称 $f_{X}(x)$ 为 $(X,Y)$ 关于 $X$ 的**边缘概率密度**。同理，$Y$ 也是连续型随机变量，其概率密度为 $f_{Y}(y)=\displaystyle\int_{-\infty}^{+\infty}f(x,y)\text{d}x$。

---

> [!definition|Definition] 条件概率密度
> 设 $(X,Y)\sim f(x,y)$，边缘概率密度 $f_{X}(x)>0$，则称
> $$
f_{Y|X}(y\mid x)=\frac{f(x,y)}{f_{X}(x)}
> $$ 
> 为 $Y$ 在 $X=x$ 条件下的**条件概率密度**。同理，$X$ 在 $Y=y$ 条件下的条件概率密度
> $$
f_{X|Y}(x\mid y)=\frac{f(x,y)}{f_{Y}(y)}
> $$

> [!note] 
> 若 $f_{X}(x)>0,f_{Y}(y)>0$，则有概率密度**乘法公式**
> $$
f(x,y)=f_{X}(x)f_{Y|X}(y\mid x)=f_{Y}(y)f_{X|Y}(x\mid y)
> $$ 
> 我们称
> $$
F_{Y|X}(y\mid x)=\int_{-\infty}^{y}f_{Y|X}(y\mid x)\text{d}y=\int_{-\infty}^{y}\frac{f(x,y)}{f_{X}(x)}\text{d}y
> $$
> 为 $Y$ 在 $X=x$ 条件下的**条件分布函数**。同理可以定义 $X$ 在 $Y=y$ 条件下的条件分布函数
> $$
F_{X|Y}(x\mid y)=\int_{-\infty}^{x}f_{X|Y}(x\mid y)\text{d}x=\int_{-\infty}^{x}\frac{f(x,y)}{f_{Y}(y)}\text{d}x
> $$




