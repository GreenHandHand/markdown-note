---
tags:
  - 矩阵分析
  - 线性代数
---

# 二次型

> [!definition|Definition] 二次型
>  $n$ 元变量 $x_{1},x_{2},\cdots,x_{n}$ 的二次齐次多项式
>  $$
\begin{aligned}
f(x_{1},x_{2},\cdots,x_{n})=a_{11}x_{1}^{2}+2a_{12}x_{1}x_{2}+\cdots&+2a_{1n}x_{1}x_{n}\\
+a_{22}x_{2}^{2}+\cdots&+2a_{2n}x_{2}x_{n}\\
+\cdots&\\
&+a_{nn}x_{n}^{2}
\end{aligned}
> $$
> 称为 $n$ 元二次型，简称二次型。

在线性代数中，我们只研究系数 $a_{ij}\in \mathbb{R}$ 的情况，故称此二次型 $f$ 为实二次型。

若将上面的式子的 $a_{ij}$ 平均分给 $x_{i}x_{j}$ 和 $x_{j}x_{i}$，则二次型的定义是可以简写为
$$
f(x_{1},x_{2},\cdots,x_{n})=\sum_{i=1}^{n}\sum_{j=1}^{n}a_{ij}x_{i}x_{j}
$$
称为*和式*，定义中的式子称为*完全展开式*。令
$$
A=\begin{bmatrix}
a_{11} & a_{12} & \cdots & a_{1n} \\
a_{21} & a_{22} & \cdots & a_{2n} \\
\vdots & \vdots &  & \vdots \\
a_{n 1} & a_{n 2} &\cdots & a_{nn}
\end{bmatrix},\ x=\begin{bmatrix}
x_{1} \\
x_{2} \\
\vdots \\
x_{n}
\end{bmatrix}
$$
则二次型可以表示为
$$
f(x)=x^{T}Ax
$$
上式称为二次型 $f(x_{1},x_{2},\cdots,x_{n})$ 的矩阵表达式，实对称矩阵 $A$ 称为二次型 $f(x)$ 的矩阵。

> [!note] 二次型唯一对应一个对称矩阵
> 二次型矩阵 $A$ 是一个实对称矩阵，其中 $A=(a_{ij}),a_{ij}=a_{ji}$，即满足 $A^{T}=A$。
>
> 实际上，如果不规定二次型是对称矩阵，那么二次型对应的矩阵就不唯一，这不利于研究二次型问题。所以我们规定，二次型的矩阵一定是对称的，如果**题目给出矩阵是非对称的，则将对角线对称的元素相加然后除以 2**。

## 合同变换

### 线性变换

对于 $n$ 元二次型 $f(x_{1},x_{2},\cdots,x_{n})$，若令
$$
\begin{cases}
x_{1}=c_{11}y_{1}+c_{12}y_{2}+\cdots+c_{1n}y_{n} \\
x_{2}=c_{21}y_{1}+c_{22}y_{2}+\cdots+c_{2n}y_{n} \\
\cdots\\
x_{n}=c_{n1}y_{1}+c_{n2}y_{2}+\cdots+c_{nn}y_{n} \\
\end{cases}
$$
记 $x=\begin{bmatrix}x_{1},x_{2},\cdots,x_{n}\end{bmatrix}^{T}$, $y=\begin{bmatrix}y_{1},y_{2},\cdots,y_{n}\end{bmatrix}$, 并使用 $C$ 表示系数
$$
C=\begin{bmatrix}
c_{11} & c_{12} & \cdots & c_{1n} \\
c_{21} & c_{22} & \cdots & c_{2n} \\
\vdots & \vdots &  & \vdots \\
c_{n 1} & c_{n 2} & \cdots & c_{nn}
\end{bmatrix}
$$
那么上式可以简写为
$$
x=Cy
$$
上式称为*线性变换*。若线性变化的系数矩阵 $C$ 可逆，即 $\left| C \right|\neq 0$，则称为*可逆线性变换*。

### 矩阵合同

如果我们对二次型 $f(x)=x^{T}Ax$ 进行线性变化，则有
$$
\begin{aligned}
f(x)&=(Cy)^{T}A(Cy)\\ &=y^{T}(C^{T}AC)y=y^{T}By\\
&=g(y)
\end{aligned}
$$
此时，我们得到的一个新二次型 $g(y)$。在上述过程中，系数矩阵 $A$ 与 $B$ 有如下关系
$$
B=C^{T}AC
$$
我们现在对上面的关系进行定义。

> [!definition|Definition] 合同二次型
> 设 $A,B$ 为 $n$ 阶矩阵，若存在可逆矩阵 $C$，使得
> $$
C^{T}AC=B
> $$ 
> 则称 $A$ 与 $B$ 合同，记作 $A\simeq B$，此时称其对应的二次型 $f(x)$ 与 $g(y)$ 为合同二次型。

> [!note] 合同满足自反、对称和传递。

> [!note]
> 1. 可逆线性变化不会改变二次型的秩。即合同矩阵的秩相同。
> 2. 对称矩阵的合同矩阵也必是对称矩阵，*~~在线性代数中，只研究对称的合同矩阵~~*。

### 二次型的标准型

> [!definition|标准形] 若二次型中只有平方项，没有交叉项，即形如 $d_{1}x_{1}^{2}+d_{2}x_{2}^{2}\cdots+d_{n}x_{n}^{2}$ 的二次型，称为标准形。

> [!note] 只要二次型中包含任何一个交叉项，那么二次型为一般形。

> [!definition|规范形] 若标准形中，系数 $d_{i}$ 的取值范围为 $\left\{ 1,-1,0 \right\}$，即形如 $x_{1}^{2}+\cdots+x_{p}^{2}-x_{p+1}^{2}-\cdots-x_{p+q}^{2}$ 的二次型称为规范形。

> [!note] 在不考虑 $d_{i}$ 顺序时，规范形唯一，标准形一般不唯一。

---

> [!definition|定理一] 任何二次型 $f(x)=x^{T}Ax$ 均可通过配方法 (作可逆线性变化 $x=Cy$) 化成标准形及规范形。

^def1

用矩阵语言表述为：任何实对称矩阵 $A$，必存在一个可逆矩阵 $C$ (不唯一) 使得 $C^{T}AC=\varLambda$，其中
$$
\begin{gather}
\varLambda=\text{diag}(d_{1},d_{2},\cdots,d_{n})\\
\text{或者 }\varLambda=\text{diag}(1,\cdots,1,-1,\cdots,-1,0,\cdots,0)
\end{gather}
$$

> [!note] 与[[线性代数/特征值与特征向量#相似对角化|相似对角化]]对比
> 这里的合同定义 $C^{T}AC$ 与相似对角化的定义 $C^{-1}AC$ 不同，一般而言，$C$ 的列向量不一定是 $A$ 的特征向量，$d_{i}$ 也不一定是特征值。
>
> 实际上，只有在 $C$ 是正交矩阵时，上面的才成立，即定理二的内容。

---

> [!definition|定理二] 任何二次型 $f(x)=x^{T}Ax$ 可以通过正交变换 $x=Qy$ 化成标准形。

^def2

用矩阵语言表示，即任何实对称矩阵 $A$，一定存在正交矩阵 $Q$ 使得
$$
Q^{-1}AQ=Q^{T}AQ=\varLambda
$$
其中 $\varLambda=\text{diag}(\lambda_{1},\lambda_{2},\cdots,\lambda_{n})$。

> [!note] 实际上就是[[线性代数/特征值与特征向量#实对称矩阵的相似对角化|实对称矩阵的相似对角化]]。

> [!tip] 若线性变换为正交变换，那么矩阵相似与矩阵合同等价。

#### 配方法

对应[[#^def1|定理一]]，这里用一个例子来说明。

> [!example]-
> 化二次型
> $$
f(x_{1},x_{2},x_{3})=x_{1}^{2}+2x_{1}x_{2}+2x_{1}x_{3}-x_{2}^{2}-2x_{2}x_{3}-x_{3}^{2}
> $$
> 为标准型，并写出所做的可逆线性变化。
> 
> 先对 $x_{1}^{2}$ 及所有含 $x_{1}$ 的混合项配完全平方：
> $$
\begin{aligned}
f(x_{1},x_{2},x_{3})=&(x_{1}+x_{2}+x_{3})^{2}-x_{2}^{2}-x_{3}^{2}-2x_{1}x_{2}-2x_{1}x_{3}\\
&-2x_{2}x_{2}+2x_{1}x_{2}+2x_{1}x_{3}-x_{2}^{2}-2x_{2}x_{3}-x_{3}^{2}\\
=&(x_{1}+x_{2}+x_{3})^{2}-2x_{2}^{2}-4x_{2}x_{3}-2x_{3}^{2}
\end{aligned}
> $$
> 接着对 $x_{2}^{2}$ 及所有含 $x_{2}$ 的混合项配完全平方：
> $$
\begin{aligned}
f(x_{1},x_{2},x_{3})=&(x_{1}+x_{2}+x_{3})^{2}-2(x_{2}^{2}+2x_{2}x_{3})-2x_{3}^{2}\\
&=(x_{1}+x_{2}+x_{3})^{2}-2(x_{2}+x_{3})^{2}+2x_{3}^{2}-2x_{3}^{2}\\
&=(x_{1}+x_{2}+x_{3})^{2}-2(x_{2}+x_{3})^{2}
\end{aligned}
> $$
> 于是可以写出 $x=Cy$ 的表达式
> $$
\begin{cases}
x_{1}+x_{2}+x_{3}=y_{1} \\
x_{2}+x_{3}=y_{2} \\
x_{3}=y_{3}
\end{cases} \iff \begin{bmatrix}
1 & 1 & 1 \\
0 & 1 & 1 \\
0 & 0 & 1
\end{bmatrix}\begin{bmatrix}
x_{1} \\ x_{2} \\ x_{3}
\end{bmatrix}=\begin{bmatrix}
y_{1} \\ y_{2} \\ y_{3}
\end{bmatrix}
> $$
> 于是可以求出 $C=\Big(\begin{smallmatrix}1&1&1\\0&1&1\\0&0&1\end{smallmatrix}\Big)^{-1}$。

> [!note]
> 1. 用配方法化二次型为标准形、规范形，若有平方项，应将平方项及其有关混合项配成完全平方。
> 2. 如果没有平方项时，作可逆线性变换 $\begin{cases}x_{1}=y_{1}+y_{2}\\x_{2}=y_{1}-y_{2}\\x_{3}=y_{3}\end{cases}$ 构造平方项，然后再配完全平方。

#### 正交变换法

对应[[#^def2|定理二]]，由于二次型是一个实对称矩阵，因此一定可以相似对角化为 $Q^{-1}AQ=Q^{T}AQ=\varLambda$ 的形式，转换方法同[[线性代数/特征值与特征向量#实对称矩阵的相似对角化|实对称矩阵的相似对角化]]。此时我们得到的特征值就是每个平方项前的系数，特征向量就是正交变化的列。

正交变换有一些良好的性质^[[[线性代数/向量组#^OrthogonalTransformation|正交变换的性质]]]，可以帮助我们解决一些特殊的问题。

> [!warning] 正交变化法的前提是二次型矩阵是实对称矩阵，在求解特征值之前要考虑清楚现在的矩阵是否是二次型的矩阵！

### 惯性定理

> [!definition|惯性定理] 无论选取什么样的可逆线性变换，将二次型化成标准形或规范形，其正项个数 $p$，负项个数 $q$ 都是不变的，其中 $p$ 称为*正惯性系数*，$q$ 称为*负惯性系数*。

> [!tip] 矩阵变换中的不变量
> - 可逆线性变换中的不变量是正负惯性系数。
> - 矩阵相似中的不变量是 $n$ 阶主子式之和 ([[线性代数/特征值与特征向量#相似矩阵的性质|相似矩阵]])。
> - 矩阵等价中的不变量是矩阵的秩 ([[线性代数/矩阵#等价矩阵|等价矩阵]])。

> [!note]
> 1. 若二次型的秩为 $r$，则 $r=p+q$。
> 2. 两个二次型合同的==充要条件==是：
> 	- 有相同的正、负惯性系数；
> 	- 或者有相同的秩及正 (或) 负惯性系数；
> 	- 或者有相同的正、负特征值个数；

## 正定二次型

> [!definition|Definition] 正定二次型
> $n$ 元二次型 $f(x_{1},x_{2},\cdots,x_{n})=x^{T}Ax$，若对任意的 $x=[x_{1},x_{2},\cdots,x_{n}]^{T}\neq 0$，均有 $x^{T}Ax>0$，则称 $f$ 为正定二次型，称二次型的对应矩阵 $A$ 为正定矩阵。
>

> [!note] 二次型正定的==充要条件==
> - $n$ 元二次型 $f=x^{T}Ax$ 正定
> - $\iff$ 对任意 $x\neq 0$，有 $x^{T}Ax>0$
> - $\iff f$ 的正惯性指数 $p=n$
> - $\iff$ 存在可逆矩阵 $D$，使得 $A=D^{T}D$
> - $\iff A\simeq E$
> - $\iff A$ 的特征值 $\lambda_{i}>0$
> - $\iff A$ 的全部顺序主子式均大于 0

> [!note] 顺序主子式
> 设 $A=(a_{ij})_{n\times n}$，则
> $$
|A_{k}|=\begin{vmatrix}
a_{11} & a_{12} & \cdots & a_{1k} \\
a_{21} & a_{22} & \cdots & a_{2k} \\
\vdots & \vdots & & \vdots \\
a_{k 1} & a_{k 2} & \cdots & a_{kk}
\end{vmatrix}
> $$
> 称为 $n$ 阶矩阵 $A$ 的 $k$ 阶顺序主子式。当 $k$ 取 $1,2,\cdots,n$ 时，就得到了 $A$ 的 $n$ 个顺序主子式。

> [!example]-
> 判断正定时一般使用充要条件中的特征值、正惯性系数和顺序主子式，但是特别的，对于形如
> $$
f(x_{1},x_{2},x_{3})=(a_{1}x_{1}+a_{2}x_{2}+a_{3}x_{3})^{2}+(b_{1}x_{1}+b_{2}x_{2}+b_{3}x_{3})^{2}+(c_{1}x_{1}+c_{2}x_{2}+c_{3}x_{3})^{2}
> $$
> 的情况，可以利用定义 $x^{T}Ax>0$ 来判断，即令上式等于零，可以得到
> $$
\begin{cases}
a_{1}x_{1}+a_{2}x_{2}+a_{3}x_{3}=0 \\
b_{1}x_{1}+b_{2}x_{2}+b_{3}x_{3}=0 \\
c_{1}x_{1}+c_{2}x_{2}+c_{3}x_{3}=0
\end{cases}
> $$
> 如果上述方程组只有零解，即系数矩阵有 $|A|=0$，说明二次型正定，否则非正定。

二次型正定的必要条件：
1. $a_{ii}>0$ (正定矩阵的每个元素都大于 0)
2. $|A|>0$ (正定矩阵的每个顺序主子式都大于 0)

> [!tip] 正定矩阵在考研中主要考查的是计算，不会过于深入。
