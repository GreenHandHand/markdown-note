# 粒子群优化算法

粒子群优化 (Particle Swarm Optimization)，受鸟群、鱼群的群体活动启发而设计。粒子群算法属于启发式算法也叫智能优化算法，其基本思想在于通过群体中个体之间的协作和信息共享来寻找最优解。

## 基本概念

粒子群算法中的基本概念有：
- 粒子：优化问题的候选解
- 位置：候选解的所在位置
- 速度：候选解移动的速度
- 适应度：评价粒子优劣的值，一般设置为目标函数的值
- 个体最佳位置：单个粒子迄今为止找到的最佳位置
- 群体最佳位置：所有粒子迄今为止找到的最佳位置

## 原理

思想：将个体经验与群体经验结合

粒子群算法初始化为一群随机的粒子（随机解），然后根据迭代找到最优解。每一次迭代中，粒子通过跟踪两个极值来更新自己：第 1 个是粒子本身所找到的最优解，这个称为个体极值；第 2 个是整个种群目前找到的最优解，这个称为全局极值。也可以不用整个种群，而是用其中的一部分作为粒子的邻居，称为局部极值。

假设在 $D$ 维搜索空间中，有 $N$ 个粒子组成一个群落，其中第 $i$ 个粒子表示一个 $D$ 维的向量，即
$$
X_i=(x_{i1},x_{i2},\cdots,x_{iD})
$$
第 $i$ 个粒子的速度表示为
$$
V_i=(v_{i1},v_{i2},\cdots,v_{iD})
$$
保存的个体最优解为 $p_{\text{best}}$，整个群落找到的群体最优解为 $g_{\text{best}}$，则第 $i$ 个粒子使用下面的公式更新其速度：
$$
v_{id}^{(n)}=wv_{id}^{(n-1)}+c_1r_1(p_{id}-x_{id}^{(n)})+c_2r_2(p_{gd}-x_{id}^{(n)})
$$
其中 $v$ 是粒子速度，$x$ 为粒子位置，$w$ 为惯性权重，$c_1,c_2$ 代表学习因子也称加速常数，$r_1,r_2$ 为随机数。该公式由三部分组成：
1. 惯性或者动量部分，反映粒子的运动习惯。
2. 认知部分，粒子有向自身历史最佳位置移动的倾向。
3. 社会部分，粒子有向群体或者领域内最佳位置移动的倾向。

使用下面的式子更新位置：
$$
x_{id}^{(n+1)}=x_{id}^{(n)}+v_{id}^{(n)}t
$$
其中 $t$ 为间隔时间，常取 1。

在粒子群算法一般含有 3 个超参数：
1. 群体大小：群体大小越大，全局搜索性能越强，但是计算资源消耗越大。
2. 惯性权重：惯性权重越大越有利于全局搜索，较小的惯性权重有利于局部搜索。
3. 加速常数：加速常数有两个，分别控制粒子对自己的历史最优位置和全局最优位置的依赖程度。设置过大会导致算法不稳定，可能陷入震荡或出现爆炸现象；设置过小则可能需要更多的迭代次数才能收敛，或者可能取得低质量的最优解。

## 伪代码

```lua
[x*] = PSO()
P = Particle_Initialization()
for i=1 to it_max:
	for each particle p in P do:
		fp = f(p)
		if fp is better than f(pBest) then
			pBest = p;
		end
	end
	gBest = best pBest in P
	for each particle p in P do
		v = w*v + c1*rand*(pBest - p) + c2*rand*(gBest - p)
		p = p + v
	end
end
```

