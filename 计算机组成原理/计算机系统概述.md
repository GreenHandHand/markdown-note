# 计算机系统概述

本节是对计算机组成原理内容的概述，介绍计算机系统中包含的各个部件。

## 计算机系统层次结构

硬件系统和软件系统共同构成了一个完整的计算机系统。
- **硬件**指有形的物理设备，是计算机系统中实际物理装置的总称。
- **软件**指在硬件上运行的程序和相关的数据及文档。

### 计算机硬件

现代的计算机都是基于冯诺依曼提出的存储程序的概念，以此概念为基础的各类计算机称为*冯诺依曼机*，其特点如下：
1. 采用存储程序的工作方式。
2. 计算机硬件系统由运算器、存储器、控制器、输入设备和输出设备组成。
3. 指令和数据以同等的地位存储在存储器中，形式上没有区别。
4. 指令和数据均使用二进制代码表示。
5. 指令由操作码和地址码组成，操作码指出操作的类型，地址码输出操作数的地址。

> [!note] 存储程序的基本思想
> 将事先编制好的程序和原始数据送入主存储器后才能执行。一旦程序被执行，就无须操作人员的干预，计算机会自动逐条执行指令，直到程序执行结束。

> [!note] 计算机中的各个功能部件
> 1. 输入设备：将程序与数据以机器可以识别和接受的方式输入计算机。*一般而言，我们会基于一个协议来处理数据 (其实就是驱动软件)，最常用的输入设备包括键盘、鼠标、扫描仪等*。
> 2. 输出设备：将计算机处理的结果以人们可以接受的形式输出。*同输入设备，常见的有显示器、打印机等*。
> 3. 存储器：存储器包含**主存储器**(也叫内存或者主存) 和**辅助存储器**(也称为外存储器或者外存)。CPU 可以直接访问主存，而外存用于辅助计算机存储更多的数据，其具体的工作原理参照[[计算机组成原理/存储系统|存储系统]]。*外存一般使用硬盘*。
> 4. 运算器：运算器是计算机中的执行部件，用于进行算术运算^[加、减、乘、除等]和逻辑运算^[与、或、非、异或、比较、移位等]。运算器的核心是**算术逻辑单元** (ALU)，还包含一些重要的寄存器，例如*累加器 (ACC)，商乘寄存器 (MQ)、操作数寄存器 (X)，变址寄存器 (IX)、基址寄存器 (BR) 等*。
> 5. 控制器：控制器是整个计算机的指挥中心，由控制器指挥各个部件协调的进行工作。*在控制器中，我们使用程序计数器 (PC)、指令寄存器 (IR) 和控制单元 (CU) 来控制程序的执行*。

> [!tip] 
> 我们一般将运算器和控制器集成到同一个芯片上，称为[[计算机组成原理/中央处理器|中央处理器]] (也就是我们常说的 CPU)。CPU 和主存储器共同构成主机，即一台计算机实际上只需要这两个部件就可以运行程序。除了主机之外的其他硬件设备 (如 IO 设备、外存等) 统称为**外部设备**，简称为外设。

> [!tip] 这一节我们仅简单了解计算机包含哪一些组件，具体的工作原理到具体的章节再学习。

### 计算机软件

软件按照其功能划分，可以分为系统软件和应用软件：
1. 系统软件：一组保证计算机系统高效、正确运行的基础软件，通常作为系统资源提供给用户使用。*系统软件包含[[操作系统/操作系统基本原理概论|操作系统]]、[[数据库/数据库系统引论#数据库管理系统|数据库管理系统]]、[[编译原理/编译器简介|语言处理程序]]、分布式软件系统、网络软件系统、标准库程序、服务性程序等*。
2. 应用软件：指用户为了解决某个应用领域的各类问题而编制的程序。

> [!note]- 程序员的分类 (不重要)
> 在本学科范畴内，编写诸如操作系统、编译程序等各种系统软件的人员称为*系统程序员*，而利用计算机支持的系统软件来编写解决具体应用问题的人员称为*应用程序员*。

> [!note] 编程语言的级别
> 1. 机器语言：也称为二进制代码语言，是机器唯一可以直接识别和执行的语言。*计算机可以参照机器语言进行寻址、运算与存储等操作*。
> 2. 汇编语言：汇编语言是使用英文单词或其缩写替代二进制的指令代码，更加容易被人们记忆和理解。机器在执行汇编语言之前，需要经过一个称为*汇编程序*的系统软件，翻译为机器语言后，才能在计算机的硬件系统上执行。
> 3. 高级语言：例如 C 语言、java 语言等，是为了方便程序设计人员写出解决问题的处理方案和解题过程的语言。*这些高级语言通常要经过编译程序，编译为汇编语言程序，然后再经过汇编程序得到机器语言程序之后才能执行；或者一些汇编程序可以直接生成机器语言程序。*

> [!seealso] 翻译程序
> 在计算机中，对语言进行翻译的程序有三种，它们分别对应三种类型的语言：
> 1. 汇编程序 (汇编器)：对应汇编语言，将汇编语言翻译为机器语言。
> 2. 解释程序 (解释器)：对应解释型语言，将语句逐条翻译为机器指令，然后执行。
> 3. 编译程序 (编译器)：对应编译型语言，将代码翻译为汇编语言或者机器语言。

在计算机中，软件和硬件具有的能力是相同的，即*一个功能，使用硬件实现和使用软件实现在用户的角度是相同的*。但是由于硬件实现的速度快、代价高，因此我们往往使用硬件实现一些最基本的算术运算、逻辑运算的功能，其他的大部分功能通过软件的扩充实现。

### 计算机系统的层次结构

一台计算机是一个软硬件的综合体，有着复杂的软件和硬件系统。通过捋情形计算机的多层次结构，可以从各种角度看到机器的有机联系，以便构成合理、高效的计算机系统。

关于计算机系统层次结构的分层方式，目前尚无统一的标准。这里根据抽象程度低到高给出一种划分方式：
1. 微程序机器 M0 (微指令系统)：由硬件直接执行微指令。
2. 传统机器 M1 (用机器语言的机器)：用微程序解释机器指令。
3. 虚拟机器 M2 (操作系统机器)：用机器语言解释操作系统。*从这一级别开始配备软件*。
4. 虚拟机器 M3 (汇编语言机器)：用汇编程序翻译成机器语言程序。
5. 虚拟机器 M4 (高级语言机器)：用编译程序翻译称汇编语言程序。

> [!example]- 计算机的层次结构
> ![[image/计算机系统概述-1.png#center]]

> [!note]
> 没有配备软件的纯硬件系统称为*裸机*，第 3 层到第 5 层称为*虚拟机*。虚拟机只对该层的观察者存在，对于某层的观察者而言，只能通过该层语言来了解和使用计算机，而不关系下层是如何工作的。
> 
> 软硬件的交界面就是*指令集体系结构*(ISA)，ISA 定义了一台计算机可以执行的所有指令的集合。可以看出，ISA 是软件能够执行的所有操作，也就是*软件可见部分*。

> [!tip] 在计算机组成原理中，我们主要讨论 M0 和 M1 两个级别，不考虑软件部分。而在操作系统中，我们主要考虑 M2、M3、M4 这些内容。

## 计算机系统的工作原理

现代的计算机都是基于冯诺依曼架构的，即使用**存储程序**的工作方式。

在开始执行程序之前，我们需要将程序所含的指令 (和数据) 按顺序存储在内存中，并使 PC 指向第一条指令所在的地址。随后的工作流程主要分为四个步骤：
1. 根据 PC 中的内容，访问内存，取出当前需要执行的指令，存放到 IR 中。
2. 根据 IR 中的内容，取出对应地址的操作数并执行对应的指令。
3. 同时 PC 值加上指令的长度 (一般称为 PC+1)，即指向下一个指令所在的地址 (这里忽略了跳转指令)。

> [!note] PC 寄存器和 IR 寄存器
> - 程序计数器 (PC) 用来存放当前欲执行指令的地址，具有自动加 1 的功能，即执行一条指令后，会自动指向下一条指令的地址，它与主存储的 MAR^[存储器地址寄存器，存放寻址，存放经过地址译码后找到的存储单元] 之间有一条直接通路。
> - 指令寄存器 (IR) 用于存放当前的指令，其内容来自主存储器中的 MDR^[存储器数据寄存器，用于暂存要从存储器中读取的值]。

> [!tip] 跳转指令的执行
> 上述过程是通过硬件实现的，因此 PC+1 和执行指令实际上是在同一个时钟周期发生的。