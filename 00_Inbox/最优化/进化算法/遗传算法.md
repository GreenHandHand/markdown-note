---
tags:
  - 最优化
  - 进化算法
aliases:
  - GA
---

# 遗传算法

***遗传算法(Genetic Algorithm, GA)*** 是一种 [[进化算法综述|进化算法]]。

## 算法描述

![[Assets/Pasted image 20230330164444.png]]

## 选择父代种群

以转动轮盘的方式抽取若干个解，每次每个解被抽中的概率正比与该解的质量。（即该解对应的函数值）

## 基因交叉

随机选取一个点，将基因序列分为两段，交叉生成后代基因序列。

### 其他版本

- 多点交叉：选取多个点将基因序列分成多段，交叉生成基因序列
- 均匀交叉：两个配对体上的每个基因以相同的概率交换

## 基因突变

子代基因序列中每个基因独立地以 p 概率突变

## 解的表达方式

- 对于一些问题，可以使用二进制进行表达，即使用二进制编码法。
- 对于一些问题，不能使用 0-1 基因序列表达，没有通解，如何进行基因交叉需要进行特殊的考量。

## 实码遗传算法

对于离散的解空间问题，可以写出基因的表达形式。但是这样的方式不能用于解空间连续的问题。对于连续解空间，有以下方法来求解：

1. 将连续的解空间离散化
2. 直接在连续空间运用遗传算法（称为用实数编码的遗传算法）

### 将连续的解空间离散化

将连续的解空间 $[x, y]$ 离散化成由 $\{a_1,\dots, a_L\}\in\{0, 1\}^L$ 表示的解空间

- 定义函数 $\Gamma(a_1, \dots, a_L)$ 计算离散解 $(a_1, \dots, a_L)$ 在连续解空间对应的值
$$
\Gamma(a_1, \dots, a_L)=x+\frac{y-x}{2^L-1}\cdot(\sum_{j=0}^{L-1}a_{L-j}\cdot 2^j)\in [x, y]
$$
- 共 $2^L$ 中取值，即 $L$ 决定了表达精度
- $L$ 越大，精度越高，但是基因序列越长，算法收敛时间越长。

这种方法的缺陷：
- 汉明悬崖：相邻的两个解序列差别可能很大，如 01111 和 10000
- 精度难以保证

### 用实数编码的遗传算法

如果要在直接在实数空间中使用遗传算法，则需要对以下几个步骤重新定义：
- 通过基因交叉生成自带种群
- 对子代种群进行基因突变

在实数编码的遗传算法中，基因交叉通过使用仿二进制基因交叉 SBX (simulated binary crossover)，基因突变可以使用均匀突变或者非均匀突变（如正态分布突变）

### SBX 仿二进制基因交叉

SBX 算子通过模仿二进制中的交叉方式，得到下面的公式：
$$
\begin{aligned}
c_i^1=\frac{1}{2}\left[(1+\beta)x_i^1+(1-\beta)x_i^2\right]\\
c_i^2=\frac{1}{2}\left[(1-\beta)x_i^1+(1+\beta)x_i^2\right]
\end{aligned}
$$
其中 $\beta$ 是由分布因子 $\eta$ 决定的随机数，$\eta$ 的值越大，则产生后代个体逼近父代的概率越大：
$$
\beta=\left\{\begin{aligned}
&(2R)^{1/(1+\eta)} & R\leq0.5\\
&1/(2-2R)^{1/(1+\eta)}& otherwise.
\end{aligned}\right.
$$
