---
tags:
  - 设计模式
---

# 设计模式概述

## 面向对象程序设计基础

[[00_Inbox/软件工程/面向对象方法学|面向对象程序设计]] (*Object-Oriented Porgramming, OOP*) 是一种范式，其基本理念是将数据块及与数据相关的行为封装成为特殊的、名为**对象**的实体。同时，对象实体的生成工作则是基于程序员给出的一系列蓝图，这些蓝图就是**类**。

### 对象与类

我们常使用 UML 来表述一个类。

![[Assets/面向对象基础.png|UML类图|500]]

> [!note]
> 在 markdown 中可以使用 mermaid 创建一个类图。
>
> > [!example]-
> >
> > ```mermaid
> > classDiagram
> > 	class Cat {
> > 		+name
> > 		+gender
> > 		+age
> > 		+weight
> > 		+color
> > 		+breathe()
> > 		+eat(food)
> > 		+run(destination)
> > 		+sleep(hours)
> > 		+meow()
> > 	}
> > ```

提取出一些类的共性，可以将其抽象为一个共有的类，这个类称为基类 (父类、超类)，继承它的类称为派生类 (子类)。子类会继承其父类的状态和行为，只需要在其中定义不同于父类的属性或行为。

在 UML 图中，我们使用三角箭头表示派生关系 (继承关系)。

![[Assets/面向对象基础-1.png|类层次结构的 UML 图|500]]

> [!note]
> 在 mermaid 中使用下面的语法表示一个派生类。
>
> > [!example]-
> >
> > ```mermaid
> > classDiagram
> > 	class Animal {
> > 		+name
> > 		+sex
> > 		+age
> > 		+weight
> > 		+color
> > 		+breathe()
> > 		+eat(food)
> > 		+run(destination)
> > 		+sleep(hours)
> > 	}
> > 
> > 	class Cat {
> > 		-isNasty: bool
> > 		+meow()
> > 	}
> > 
> > 	class Dog {
> > 		-bestFriend: Human
> > 		+bark()
> > 	}
> > 	Animal <|-- Cat
> > 	Animal <|-- Dog
> > ```

> [!tip]- 如果展示类之间的关系比展示其内容更加重要的话，就可以对 UML 图中的类进行简化。
> ![[Assets/面向对象基础-2.png]]

### 面向对象特性

面向对象具有四个基本概念，使其区别于其他程序设计范式。
- 抽象：对象只需要模拟真实对象的特定属性和行为即可，其他内容可以忽略。
- 封装：一个对象对其他对象隐藏其部分状态和行为，仅向程序其他部分暴露有限的接口。
- 继承：根据已有类创建新类。
- 多态：对于相同名字的方法，根据运行时对象的类型执行对应对象的方法。

> [!note] 接口
> **接口** (*interface*) 代表对象的公有部分。在现代面向对象语言中，这通常使用 `interface` 或者 `protocol` 关键词来声明。接口机制允许你定义对象之间交互的协议。如果父类实现了一个接口，那么它的所有子类都需要实现该接口。
>
> 在 UML 图中，接口的定义与类一致，但是他们仅拥有方法。我们使用虚线三角箭头表示类实现了接口。
> ![[Assets/面向对象基础-3.png|500]]
>
> > [!example]-
> >
> > ```mermaid
> > classDiagram
> > direction TB
> >     class Airport {
> > 	    ...
> > 	    +accept(vehicle: FlyingTransport)
> >     }
> >     class FlyingTransport {
> > 	    +fly(origin, destination, passengers)
> >     }
> >     class Helicopter {
> > 	    ...
> > 	    +fly(origin, destination, passengers)
> >     }
> >     class Airplane {
> > 	    ...
> > 	    +fly(origin, destination, passengers)
> >     }
> >     class DomesticatedGryphon {
> > 	    ...
> > 	    +fly(origin, destination, passengers)
> >     }
> > 	<<Interface>> FlyingTransport
> >     Airport --> FlyingTransport
> >     FlyingTransport <|.. Helicopter
> >     FlyingTransport <|.. Airplane
> >     FlyingTransport <|.. DomesticatedGryphon
> > 
> > ```

### 对象之间的关系

- 依赖：如果修改一个类的定义会造成另一个类的变化，那么他们之间存在依赖关系。
- 关联：一个对象使用另一个对象或与另一个对象进行交互的关系。
- 聚合：多个对象间的整体对部分的关系。通常来说，聚合关系中一个对象拥有一组其他对象，并扮演着容器的角色。
- 组合：一种特殊的聚合类型，其中一个对象由一个或多个其他对象的实例构成。组件仅能作为容器的一部分存在。

> [!example]- 依赖
> 教授依赖于课程
> ```mermaid
> ---
> config:
>   class:
>     hideEmptyMembersBox: true
> ---
> classDiagram
> direction LR
> 	class 教授
> 	class 课程
> 
> 	教授 ..> 课程
> ```

> [!example]- 关联
> 教授与学生交流。
> ```mermaid
> ---
> config:
>   class:
>     hideEmptyMembersBox: true
> ---
> classDiagram
> direction LR
> class 教授
> class 学生
> 
> 教授 --> 学生
> ```

> [!example]- 聚合
> 院系和教授是聚合关系，一个院系包含多个教授。
> ```mermaid
> ---
> config:
>   class:
>     hideEmptyMembersBox: true
> ---
> classDiagram
> direction LR
> class 教授
> class 院系
> 
> 院系 o--> 教授
> ```

> [!example]- 组合
> 大学由院系构成。
> ```mermaid
> ---
> config:
>   class:
>     hideEmptyMembersBox: true
> ---
> classDiagram
> direction LR
> class 院系
> class 大学
>  
> 大学 *--> 院系
> ```

### 总结

下面的图给出了 UML 中不同关系的强弱。
![[Assets/面向对象基础-4.png|500]]

- 依赖：对类 B 修改会影响到类 A。
- 关联：对象 A 知道对象 B。类 A 依赖于类 B。
- 聚合：对象 A 知道对象 B 且由 B 构成。类 A 依赖于类 B。
- 组合：对象 A 知道对象 B、由 B 构成而且管理着 B 的生命周期。类 A 依赖于类 B。
- 实现：类 A 定义的方法由接口 B 声明。对象 A 可以被视为对象 B。类 A 依赖于类 B。
- 继承：类 A 继承类 B 的接口和实现，但是可以对其进行扩展。对象 A 可以被视为对象 B。类 A 依赖于类 B。

## 设计模式

**设计模式**是软件设计中常见问题的典型解决方案。它们就像根据需求进行调整的预制蓝图，可以用于解决代码中反复出现的设计问题。

> [!note] 设计模式与算法的区别
> 设计模式和算法都是已知特定问题的典型解决方案。但是算法总是明确达成特定目标所需的一系列步骤，而模式则是对解决方案的更高层次描述。同一模式在两个不同程序中的实现代码可能会不一样。

大部分模式都会遵循特定的形式，以便在不同情况下使用。模式的描述通常包含以下部分：
- **意图**：简要描述问题和解决方案。
- **动机**：进一步解释问题并说明模式会如何提供解决方案。
- **结构**：展示模式的各个部分和它们之间的关系。
- **实现**：使用不同的编程语言实现。

### 模式的分类

不同设计模式在其复杂程度、细节层次以及在整个系统中的应用范围等方面各不相同。
- **惯用技巧**：最基础、底层的模式，一般只能在一种编程语言中使用。
- **架构模式**：最通用、高层的模式，可以在任何编程语言中使用，通常用于整个应用程序的架构设计。

按照意图或目的来分类，模式还可以分为：
- **创建型模式**：提供创建对象的机制，增加已有代码的灵活性和可复用性。
- **结构型模式**：如何将对象和类组装成较大的结构，并同时保持结构的灵活和高效。
- **行为模式**：负责对象间的高效沟通和职责委派。

## 为什么学习设计模式？

设计模式是针对软件设计中常见问题的工具箱，其中的工具就是经过时间验证的解决方案。即使你从未约见过这些问题，了解模式仍然非常有用，因为它能指导你如何使用面向对象的设计原则来解决各种问题。

此外，设计模式定义了一种让你和团队成员能够高效沟通的通用语言。你只需要抛出一个设计模式的名字，所有人都会理解这条建议背后的想法。

---

| [[00_Inbox/设计模式/软件设计原则|软件设计原则]] >