---
aliases:
  - segmentation
tags:
  - 计算机视觉
---

# 图像分割

图像分割 (Image Segmentation) 的目标是识别图像中的像素组。将图像中独立的像素转换为连续的物体，或者将外观相似的像素组合在一起。
![[Pasted image 20240106142626.png]]

## 聚类

传统计算机视觉中一般将图像分割问题转换为 [[聚类]] 问题。因为聚类的目的与图像分割的目的相同，是将相似的样本聚在在一起。

但是在视觉任务中，直接对像素使用聚类方法，得到的效果很差，因为图像中的像素是一种抽象程度较高的信息，我们没有什么较好的方式衡量两个像素之间的相似度。

如何找到一个衡量相似度的方法是一个具有挑战性的问题。目前的思想主要集中在：
1. 使用 tokens：将图像划分为 tokens，对包含信息更多的 tokens 进行聚类
2. 自底向上聚类 (Bottom up)：在局部有相关性的 tokens 应当被聚为一类
3. 自顶向下聚类 (Top down)：属于同一物体的 tokens 应当被聚为一类

这些思想并不冲突，我们可以同时使用多种思想。在计算机视觉中，常用的聚类方法包括 [[聚类#层次聚类|层次聚类]]，[[聚类#k均值聚类|K-Means]]，Mean-Shift。

## Mean-Shift

见 [[mean shift]]。

## 基于图的图像分割

图是一种性质很好的结构，基于图的数据处理在这些年也快速的发展。这部分介绍一种简单的，基于图的聚类方式。

设一个无向图 $G=(V,E)$，其中 $V$ 是点集，$E$ 是边集，$w(v_i,v_j)$ 是边 $E_{ij}$ 的权重，$S$ 是图像的一个分割。这种图聚类算法通过计算图的不同分割来进行聚类，对于一个连通图，两个子图是否可以分割使用下面的条件进行判断：
$$
Merge(C_1,C_2)=\begin{cases}True&if\ dis(C_1,C_2)<in(C_1,C_2)\\False& otherwise\end{cases}
$$
其中 $dis(C_1,C_2)$ 表示两个子图间权重最小的边，$in(C_1,C_2)$ 表示两个子图内部权重最大的边。即
$$
\begin{aligned}
dis(C_1,C_2)&=\min_{v_i\in C_1,v_j\in C_2} w(v_i,v_j)\\
in(C_1,C_2)&=\min_{C\in\{C_1,C_2\}}\left[\max_{v_i,v_j\in C}\left[w(v_i,v_j)+\frac{k}{|C|}\right]\right]
\end{aligned}
$$
其中 $k/|C|$ 表示类别中模型容忍类内结点的程度，较大的 $k$ 可以容忍较大距离的结点在同一个类别中。

在进行图像分割时，我们有以下策略：
- 将图像中的像素点投影到一个特征空间 $(x,y,r,g,b)$。
- 使用完全图表示图像，权重使用两个像素的强度差表示
- 使用完全图表示图像，权重使用特征空间中的欧式距离
- 不使用完全图，对于每个点，只连接距离他们最近的 $k$ 个点，确保可以在 $O(k\log k)$ 复杂度完成。